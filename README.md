# Passman - корпоративный менеджер паролей

Программа позволяет хранить пароли и распределять доступ между группами пользователей. Регистрация в программе ограничена инвайт кодами, которые создаёт администратор.

Первый пользователь admin/admin - сразу же смените пароль после первого входа.

## 1. Установка переменных окружения в файле env

Настройки приложения

- **ASPNETCORE_ENVIRONMENT** - Development - по умолчания если хотите просмтривать swagger, Production нужно указать явно если нужно скрыть swagger.

- **FRONTEND_URL** - URL на котором будет открываться фронт приложения, используется для генерации ссылок в письмах. По-умолчанию добавляется в CORS политику

Данные для подключения к БД

- **POSTGRES_DB** - название для базы данных
- **POSTGRES_USER** - имя пользователя БД
- **POSTGRES_PASSWORD** - пароль БД
- **DB_PORT** - порт для БД

Настройки портов

- **FRONTEND_PORT** - Порт веб приложения
- **BACKEND_PORT** - порт для бэкэнда

Настройки CORS (опционально)

- **ALLOWED_ORIGINS** - дополнительные адреса для CORS политики, несколько адресов писать в строку через ';'

Данные для отправки писем через почтовый сервер. Подключение по SMTP

- **EMAIL_HOST**
- **EMAIL_PORT**
- **EMAIL_EMAIL**
- **EMAIL_PASSWORD**

## 2. Настройка файла config.js

Расположение относительно docker-compose.yaml ./config/config.js

```js
window.config = {};
window.config.BACKEND_URL = 'http://YOUR_BACKEND_URL:2058/api/v1';
```

## 3. Запуск

```bash
docker-compose up
```

Зайдите на страницу, приложения, в окне авторизации для первого запуска используйте логин и пароль admin/admin.
После этого вам нужно защитить пользователя по умолчанию, сменив пароль в своём профиле.

Если каким-то образом в системе не окажется ни одного администратора или пользователя с ником admin, то можно будет снова зайти по данным admin/admin.

Для того, чтобы новые пользователи могли зарегистрироваться, необходимо создать код приглашения и дать ссылку для регистрации для пользователей. Для каждого кода приглашения можно настраивать группы и роль, которую получит пользователь при регистрации.

Администратор так же может сам добавить нового пользователя. Пользователь получит письмо с адресом приложения и данными для входа.

Группы пользователей предназначены для распределения доступа. Администратор может для каждой группы пользователей предоставлять доступ на чтение или запись к различным папкам, содержащим пасскарды.

Один пользователь может состоять в нескольких группах. Права для каждой папки рассчитываются по максимальному значению из всех групп, в которых он состоит.

Пользователь, который имеет полный доступ к папке может создавать и редактировать пасскарды и папки в ней, а так же перемещать саму папку, но только в корень или в те папки, к которым у него есть тоже полный доступ.

При создании пользователем новой папки, предоставляется полный доступ к этой папке группе, в которой он состоит, которая имеет полный доступ к родительской папке. Если таких групп несколько, то берётся первая по очереди.

Для группы пользователей устанавливается уровень доступа к каждой папке. Уровни доступа могут быть:

- none - нет доступа
- readonly - только чтение, позволяет только просматривать содержимое
- fullaccess - полный доступ, или запись, позволяет создавать или изменять содержащиеся в папке пасскарды и папки, а так же перемещать саму папку

## Доп сведения

- При необоходимости подключить программу к внешней БД можно удалить сервис db из dockercompose файла, а для backend указать свои данные для подключения к БД.

- При разворачивании нового экземпляра программы будет автоматически сгенерирован RSA ключ для шифрования паролей. Он будет помещён рядом с исполняемым файлом и иметь относительный путь ./RSA/key.xml

- При разворачивании в докере необходимо поместить ключ RSA в volume или привязать его к локальной папке.

- В случае переноса экземпляра программы при разворачивании можно перенести ключ шифрования и копию БД через волюмы, путём привязки их к локальной папке

- Экспорт в формате passman.json имеет булевый параметр encrypted, который позволяет делать экспорт в открытую с расшифрованными паролями, либо с зашифрованными.

- В случае экспорта с зашифрованными паролями этот файл можно импортировать в другой экземпляр приложения, предварительно подсунув туда тот же ключ шифрования.

- Чтобы использовать самую последнюю версию приложения, можно склонировать репозитеории бэка и фронта, ветки dev, сбилдить их образы и использовать их в docker-compose файле
