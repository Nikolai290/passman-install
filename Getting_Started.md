# Passman - корпоративный менеджер паролей

Программа позволяет хранить пароли и распределять доступ между группами пользователей. Регистрация в программе ограничена инвайт кодами, которые создаёт администратор.

Первый пользователь admin/admin - сразу же смените пароль после первого входа.

## 1. Установка переменных окружения в файле env

- **POSTGRES_DB** - название для базы данных
- **POSTGRES_USER** - имя пользователя БД
- **POSTGRES_PASSWORD** - пароль БД
- **FRONTEND_PORT** - Порт приложения
- **BACKEND_PORT** - порт для бэкэнда
- **DB_PORT** - порт для БД
- **LOCAL_IP** - !Важно указать ваш локальный IP
- **FRONTEND_URL** - URL на котором будет открываться фронт приложения, используется для генерации ссылок в письмах
- **ASPNETCORE_ENVIRONMENT** - Development - по умолчания если хотите просмтривать swagger, Production нужно указать явно если нужно скрыть swagger

## 2. Настройка appsettings.\*.json

В названии необходимо указать название среды, соответствующее переменной **_ASPNETCORE_ENVIRONMENT_**

### Раздел MainDbSettings

Содержит настройки подключения к БД. Можно оставить пустые строчки, либо продублировать значения из переменных окружения. Настройки всё-равно берутся преимущественно из переменных окружения, только потом из файла appsettings

### Раздел MailSettings

Необходимо указать настройки для доступа по smtp к почте приложения, с которой будет осуществляться оповещение пользователей. Используйте пароль приложения для почтовых сервисов.

### Раздел PassmanSettings

Содержит прочие настройки приложения

- **MaxLengthOfTextFields** - ограничение максимальной длинны некоторых текстовых полей, например названий папок
- **MinPasswordLengthForUsers** - ограничение минимальной длины пароля для регистрирующихся пользователей
- **FrontEndUrl** - Домен на котором будет доступен фронт приложения, берётся отсюда если не указан в переменных окружения

### Настройки безопасности

- **AllowedOrigins** - список url через точку с запятой с которых будут посылаться запросы на бэк
- **AllowedHosts** - список хостов через точку с запятой с которых будут посылаться запросы на бэк

### 2. Задание собственного RSA ключа - опционально

Если будет использоваться база, которая уже шифровалась по какому-то ключу, то этот ключ можно поместить в файл ./RSA/key.xml со следующей структурой:

```
<RSAKeyValue>
  <Modulus> </Modulus>
  <Exponent> </Exponent>
  <P> </P>
  <Q> </Q>
  <DP> </DP>
  <DQ> </DQ>
  <InverseQ> </InverseQ>
  <D> </D>
</RSAKeyValue>
```

Если пропустить этот шаг, то приложение сгенерирует новый ключ при первом запуске. Он будет сохранён в volumes с названием rsa для переиспользования после перезапусков контейнеров

### 3. Запуск контейнеров

Для запуска контейнеров выполните скрипт **_install.bash_**

### 4. Обновление приложения

Для обновления приложения ознакомьтесь с инструкцией, могут появиться или измениться какие-то настройки.

Остановите контейнеры frontend и backend и удалите образы.

После этого так же выполните скрипт, он подятнет изменения с гитхаба, пересоздаст образы и запустит контейнеры снова.

База данных будет сохранена в volumes а программа сама применит нужные миграции к схеме БД.
